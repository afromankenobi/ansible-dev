- name: Install zsh
  pacman:
    name: zsh
    state: present

- name: Clone OhmyZsh
  become: false
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git 
    dest: ~/.oh-my-zsh
    accept_hostkey: yes

- name: Default shell
  become: false
  expect:
    command: "chsh -s /usr/bin/zsh"
    responses:
      Password:
        - "{{ user_password }}"
    creates: ".shell_is_zsh"
